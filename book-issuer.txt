https://stackoverflow.com/questions/54397463/getting-error-get-http-localhost9443-metrics-dial-tcp-127-0-0-19443-conne



Your prometheus container isn't running on host network. It's running on its own bridge (the one created by docker-compose). Therefore the scrape config for peer should point at the IP of the peer container.

Recommended way of solving this:

    Run prometheus and grafana in the same network as the fabric network. In you docker-compose for prometheus stack you can reference it like this:

networks:
  default:
    external:
      name: <your-hyperledger-network>

(use docker network ls to find the network name )

Then you can use http://<peer_container_name>:9443 in your scrape config
---


    I've added prometheus and grafana configuration in docker-compose.yml itself. i added networks: basic: driver: bridge at the top. Prometheus is working fine. The targets are up when seen on the prometheus interface. However when I'm adding datasource localhost:9443 in grafana, it says HTTP Bad error Gateway. – 
    Kartik Chauhan
    Jan 28, 2019 at 9:40
    Upon adding networks: default: external: name: basic in docker-compose.yml, I'm getting errror 'Network basic declared as external, but could not be found. Please create the network manually using docker network create basic and try again.' – 
    Kartik Chauhan
    Jan 28, 2019 at 9:44
    On inspecting network by doing docker network inspect <network-name>, I can see prometheus and grafana containers part of the same network as other fabric containers are. – 
    Kartik Chauhan
    Jan 28, 2019 at 10:18
    The network used by the "basic-network" sample fabric is called "net_basic" (rather than "basic"). – 
    R Thatcher
    Jan 28, 2019 at 10:46
    1
    @KartikChauhan in Grafana you should be adding only the prometheus as data source - i.e prometheus:9090 – 
    antweiss
    Jan 28, 2019 at 11:16


